{"categories":[{"id":3,"name":"Domain","labels":["Domain"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"highvalue","exclude":false,"dataType":"boolean"},{"name":"domain","exclude":false,"dataType":"string"},{"name":"betweenness","exclude":false,"dataType":"number"},{"name":"betweennessCalibrated","exclude":false,"dataType":"bigint"},{"name":"count","exclude":false,"dataType":"bigint"},{"name":"neo4jImportId","exclude":false,"dataType":"string"},{"name":"betweennessScore","exclude":false,"dataType":"number"}],"createdAt":1600197869932,"lastEditedAt":1652796881665,"color":"#F79767","size":1,"icon":"8EDB1503-B54A-4C25-B4BD-DC85A55BFDCA","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"],"styleRules":[]},{"id":4,"name":"GPO","labels":["GPO"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"domain","exclude":false,"dataType":"string"},{"name":"objectid","exclude":false,"dataType":"string"},{"name":"betweennessCalibrated","exclude":false,"dataType":"bigint"},{"name":"betweenness","exclude":false,"dataType":"number"},{"name":"count","exclude":false,"dataType":"bigint"},{"name":"neo4jImportId","exclude":false,"dataType":"string"}],"createdAt":1600197870715,"lastEditedAt":1643843778514,"color":"#57C7E3","size":1,"icon":"447F7883-95B5-4D34-9C93-F10804FB7A18","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"],"styleRules":[]},{"id":5,"name":"Group","labels":["Group"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"objectid","exclude":false,"dataType":"string"},{"name":"highvalue","exclude":false,"dataType":"boolean"},{"name":"domain","exclude":false,"dataType":"string"},{"name":"enabled","exclude":false,"dataType":"boolean"},{"name":"lastlogon","exclude":false,"dataType":"bigint"},{"name":"displayname","exclude":false,"dataType":"string"},{"name":"pwdlastset","exclude":false,"dataType":"bigint"},{"name":"owned","exclude":false,"dataType":"boolean"},{"name":"betweenness","exclude":false,"dataType":"number"},{"name":"betweennessCalibrated","exclude":false,"dataType":"bigint"},{"name":"count","exclude":false,"dataType":"bigint"},{"name":"neo4jImportId","exclude":false,"dataType":"string"},{"name":"betweennessScore","exclude":false,"dataType":"number"}],"createdAt":1600197871387,"lastEditedAt":1652796266609,"color":"#D9C8AE","size":1,"icon":"1BA78CC1-ED89-46D5-9D2B-D78DC944A59D","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"],"styleRules":[{"type":"single","size":2,"minSize":1,"maxSize":2,"minColor":"#D5EEE2","midColor":"#81CCA8","maxColor":"#428C6A","color":"#F16667","basedOn":"highvalue_boolean","condition":"is-true","applyColor":true,"applySize":true,"id":"rule:1643824354333"}]},{"id":6,"name":"OU","labels":["OU"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"objectid","exclude":false,"dataType":"string"},{"name":"blocksInheritance","exclude":false,"dataType":"boolean"},{"name":"domain","exclude":false,"dataType":"string"},{"name":"betweennessCalibrated","exclude":false,"dataType":"bigint"},{"name":"betweenness","exclude":false,"dataType":"number"},{"name":"count","exclude":false,"dataType":"bigint"},{"name":"neo4jImportId","exclude":false,"dataType":"string"}],"createdAt":1600197872063,"lastEditedAt":1643843778545,"color":"#848484","size":1,"icon":"0D871CD1-A03E-4565-B720-D6BC8DF681AB","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"],"styleRules":[]},{"id":8,"name":"Computer","labels":["Computer"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"objectid","exclude":false,"dataType":"string"},{"name":"operatingsystem","exclude":false,"dataType":"string"},{"name":"enabled","exclude":false,"dataType":"boolean"},{"name":"owned","exclude":false,"dataType":"boolean"},{"name":"domain","exclude":false,"dataType":"string"},{"name":"highvalue","exclude":false,"dataType":"boolean"},{"name":"betweenness","exclude":false,"dataType":"number"},{"name":"betweennessCalibrated","exclude":false,"dataType":"bigint"},{"name":"count","exclude":false,"dataType":"bigint"},{"name":"neo4jImportId","exclude":false,"dataType":"string"},{"name":"betweennessScore","exclude":false,"dataType":"number"}],"createdAt":1600258220865,"lastEditedAt":1652796266634,"color":"#ECB5C9","size":1,"icon":"63AF6740-290B-43AD-8EE4-9B4966249BD6","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"],"styleRules":[{"type":"single","size":1,"minSize":1,"maxSize":2,"minColor":"#D5EEE2","midColor":"#81CCA8","maxColor":"#428C6A","minPoint":"unprocessed","maxPoint":"unprocessed","color":"#DA7194","basedOn":"highvalue_boolean","valuesMapper":[],"existingValues":[],"applyColor":true,"applySize":false,"condition":"is-true","id":"rule:1643824348697"}]},{"id":9,"name":"User","labels":["User"],"properties":[{"name":"name","exclude":false,"dataType":"string"},{"name":"objectid","exclude":false,"dataType":"string"},{"name":"enabled","exclude":false,"dataType":"boolean"},{"name":"lastlogon","exclude":false,"dataType":"bigint"},{"name":"displayname","exclude":false,"dataType":"string"},{"name":"pwdlastset","exclude":false,"dataType":"bigint"},{"name":"hasspn","exclude":false,"dataType":"boolean"},{"name":"owned","exclude":false,"dataType":"boolean"},{"name":"domain","exclude":false,"dataType":"string"},{"name":"betweenness","exclude":false,"dataType":"number"},{"name":"betweennessCalibrated","exclude":false,"dataType":"bigint"},{"name":"count","exclude":false,"dataType":"bigint"},{"name":"neo4jImportId","exclude":false,"dataType":"string"},{"name":"betweennessScore","exclude":false,"dataType":"number"}],"createdAt":1600274897791,"lastEditedAt":1652796266654,"color":"#569480","size":1,"icon":"DB188874-D25F-4B34-A296-E5E950072319","captionKeys":["0_CATEGORY_NAME_CAPTION_KEY","name"],"styleRules":[{"type":"single","size":4,"minSize":1,"maxSize":2,"minColor":"#D5EEE2","midColor":"#81CCA8","maxColor":"#428C6A","minPoint":"unprocessed","maxPoint":"unprocessed","color":"#78d4b4","basedOn":"name_string","valuesMapper":[],"existingValues":[],"applyColor":true,"applySize":true,"condition":"equals","conditionValue":"BWEST00174@TESTLAB.LOCAL","id":"rule:1643824350859"},{"type":"single","size":4,"minSize":1,"maxSize":2,"minColor":"#D5EEE2","midColor":"#81CCA8","maxColor":"#428C6A","minPoint":"unprocessed","maxPoint":"unprocessed","color":"#78D4B4","basedOn":"name_string","valuesMapper":[],"existingValues":[],"applyColor":true,"applySize":true,"condition":"equals","conditionValue":"SNAZAR00121@TESTLAB.LOCAL","id":"rule:1643824356097"}]}],"name":"Windows Domains","id":"073bc800-f789-11ea-adae-d98d2fa85eac","relationshipTypes":[{"id":"GpLink","name":"GpLink","properties":[{"propertyKey":"enforced","type":"GpLink","dataType":"boolean"},{"propertyKey":"isacl","type":"GpLink","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"Contains","name":"Contains","properties":[{"propertyKey":"isacl","type":"Contains","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"GenericAll","name":"GenericAll","properties":[{"propertyKey":"isacl","type":"GenericAll","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"Owns","name":"Owns","properties":[{"propertyKey":"isacl","type":"Owns","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"WriteOwner","name":"WriteOwner","properties":[{"propertyKey":"isacl","type":"WriteOwner","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"WriteDacl","name":"WriteDacl","properties":[{"propertyKey":"isacl","type":"WriteDacl","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"DCSync","name":"DCSync","properties":[{"propertyKey":"isacl","type":"DCSync","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"GetChanges","name":"GetChanges","properties":[{"propertyKey":"isacl","type":"GetChanges","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"GetChangesAll","name":"GetChangesAll","properties":[{"propertyKey":"isacl","type":"GetChangesAll","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"MemberOf","name":"MemberOf","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"AdminTo","name":"AdminTo","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"CanRDP","name":"CanRDP","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"ExecuteDCOM","name":"ExecuteDCOM","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"AllowedToDelegate","name":"AllowedToDelegate","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"HasSession","name":"HasSession","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"AddMember","name":"AddMember","properties":[{"propertyKey":"isacl","type":"AddMember","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"ForceChangePassword","name":"ForceChangePassword","properties":[{"propertyKey":"isacl","type":"ForceChangePassword","dataType":"boolean"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"PATH","name":"PATH","properties":[{"propertyKey":"count","type":"PATH","dataType":"bigint"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"RAW_PATH","name":"RAW_PATH","properties":[],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]},{"id":"PATH_0","name":"PATH_0","properties":[{"dataType":"number","propertyKey":"cost","type":"PATH_0"}],"color":"#848484","size":1,"captionKeys":["0_REL_TYPE_CAPTION_KEY"],"styleRules":[]}],"palette":{"colors":["#FFE081","#C990C0","#F79767","#57C7E3","#F16667","#D9C8AE","#8DCC93","#ECB5C9","#4C8EDA","#FFC454","#DA7194","#569480","#848484","#D9D9D9"],"currentIndex":11},"createdAt":1643824358682,"lastEditedAt":1643824358682,"templates":[{"name":"Attack paths from User","id":"tmpl:1616093652983","createdAt":1616093652983,"text":"Attack paths from user $name","cypher":"MATCH (u:User {name:$name })\nWITH u\n\nMATCH (crownJewel {highvalue:true})\nWITH u, id(crownJewel) AS crownJewelId\n\nCALL gds.shortestPath.dijkstra.stream(\"attackPaths\", {\n    sourceNode: id(u), \n    targetNode: crownJewelId\n}) YIELD path\nRETURN path","params":[{"name":"$name","dataType":"String","collapsed":false,"suggestionLabel":null,"suggestionProp":null,"suggestionBoolean":false,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"Show schema","id":"tmpl:1616083241800","createdAt":1616083241800,"text":"Show schema","cypher":"call apoc.meta.graph() YIELD nodes, relationships\nWITH [n IN nodes WHERE apoc.convert.toMap(n).name <> \"HighValue\"] AS nodes, relationships\nRETURN nodes, relationships","params":[],"hasCypherErrors":false},{"name":"Visualize attack paths","id":"tmpl:1616080963770","createdAt":1616080963770,"text":"Attack paths to crown jewel with id $name","cypher":"MATCH (crownJewel {objectid:$name})\nWITH id(crownJewel) AS crownJewelId\n\nMATCH (n) WHERE n.highvalue IS NULL\nWITH id(n) AS sourceId, crownJewelId\n\nCALL gds.shortestPath.dijkstra.stream(\"attackPaths\", {\n    sourceNode: sourceId, \n    targetNode: crownJewelId\n}) YIELD path\nRETURN path","params":[{"name":"$name","dataType":"String","collapsed":false,"suggestionLabel":null,"suggestionProp":null,"suggestionBoolean":false,"cypher":"RETURN ['S-1-5-21-883232822-274137685-4173207997-512']"}],"hasCypherErrors":false},{"name":"Common access between $userA and $userB","id":"tmpl:1616080693504","createdAt":1616080693504,"text":"Common access between $userA and $userB","cypher":"CALL {\n    MATCH (u:User {name:$userA})-[:MemberOf*1..]->(:Group)-[:CanRDP]->(c:Computer)\n    RETURN u AS user, collect(DISTINCT c) AS computers\n    UNION ALL\n    MATCH (u:User {name:$userB})-[:MemberOf*1..]->(:Group)-[:CanRDP]->(c:Computer)\n    RETURN u AS user, collect(DISTINCT c) AS computers\n}\nWITH collect(user) AS users, collect(computers) AS computers\nWITH users[0] AS a, users[1] AS b, apoc.coll.intersection(computers[0], computers[1]) AS same\nUNWIND same AS computer\nMATCH p=(u:User)-[:MemberOf*1..]->(:Group)-[:CanRDP]->(computer:Computer)\nWHERE u = a OR u = b\nRETURN p\n","params":[{"name":"$userA","dataType":"String","collapsed":false,"suggestionLabel":"User","suggestionProp":"name","suggestionBoolean":false,"cypher":null},{"name":"$userB","dataType":"String","collapsed":false,"suggestionLabel":"User","suggestionProp":"name","suggestionBoolean":false,"cypher":null}],"hasCypherErrors":false},{"name":"High value entities","id":"tmpl:1614788277442","createdAt":1614788277442,"text":"High value entities","cypher":"match (n {highvalue: true}) RETURN n","params":[],"hasCypherErrors":false},{"name":"Everyone with RDP access","id":"tmpl:1600198268457","createdAt":1600198268457,"text":"Everyone with RDP access in domain $domain","cypher":"MATCH (u:User)\nCALL apoc.path.expand(u, 'MemberOf>|CanRDP>', 'Group|/Computer', 1, 10) YIELD path\nRETURN path","params":[{"name":"$domain","dataType":"String","suggestionLabel":"Domain","suggestionProp":"name","cypher":null}],"hasCypherErrors":false},{"name":"All groups for user $name","id":"tmpl:1600199865240","createdAt":1600199865240,"text":"All groups for user $name","cypher":"MATCH p=(:User {name: $name})-[:MemberOf*1..]->(g:Group)\nRETURN p","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"RDP access for user $name","id":"tmpl:1600200122163","createdAt":1600200122163,"text":"RDP access for user $name","cypher":"MATCH p=(:User {name:$name})-[:CanRDP]->(:Computer)\nRETURN p","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"Session hop starting with $name","id":"tmpl:1600220490892","createdAt":1600220490892,"text":"Session hop starting with $name","cypher":"MATCH (g:Group {name:\"DOMAIN ADMINS@TESTLAB.LOCAL\"})<-[r:MemberOf]-(da:User)\nMATCH (u:User {name:$name})\nWITH *, collect(da) AS domainAdmins\nUNWIND domainAdmins AS target\nCALL apoc.algo.allSimplePaths(u, target, \"HasSession\", 20) YIELD path\nRETURN path, g, r","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"Remote abilities for user $name","id":"tmpl:1600225079857","createdAt":1600225079857,"text":"Remote abilities for user $name","cypher":"MATCH p=(:User {name:$name})-[:CanRDP|ExecuteDCOM|AllowedToDelegate]->(:Computer)\nRETURN p\n","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"Who could a given user impact?","id":"tmpl:1600225922988","createdAt":1600225922988,"text":"Who could $name impact?","cypher":"MATCH p=(:User {name:$name})-[:CanRDP|ExecuteDCOM|AllowedToDelegate]->(:Computer)-[:HasSession]-()\nRETURN p LIMIT 100\nUNION\nMATCH p=(:User {name:$name})-[:MemberOf*1..]->(:Group)-[:CanRDP|ExecuteDCOM|AllowedToDelegate]->(:Computer)-[:HasSession]-()\nRETURN p LIMIT 50","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"All delegation paths","id":"tmpl:1600256907596","createdAt":1600256907596,"text":"All delegation paths","cypher":"MATCH p=(c:Computer)-[:AllowedToDelegate*1..]->(:Computer)\nWITH p, size(nodes(p)) AS n\nRETURN p ORDER BY n DESC","params":[],"hasCypherErrors":false},{"name":"Delegation trees of size > $N","id":"tmpl:1600257738597","createdAt":1600257738597,"text":"Delegation trees of size > $N","cypher":"MATCH (c:Computer)-[:AllowedToDelegate]->()\nCALL apoc.path.subgraphAll(c, {bfs:false, maxLevel: 10, relationshipFilter: 'AllowedToDelegate>'}) \nYIELD nodes, relationships\nWITH *, size(nodes) AS n WHERE n > $N\nRETURN nodes, relationships ORDER BY n DESC\nLIMIT 50","params":[{"name":"$N","dataType":"Integer","suggestionLabel":null,"suggestionProp":null,"cypher":"return [2, 3, 4, 5, 6]"}],"hasCypherErrors":false},{"name":"Remote abilities by groups for user $name","id":"tmpl:1600268597830","createdAt":1600268597830,"text":"Remote abilities by groups for user $name","cypher":"MATCH p=(:User {name:$name})-[:MemberOf*1..]->(:Group)-[:CanRDP|ExecuteDCOM|AllowedToDelegate]->(:Computer)\nRETURN p","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"DSTEM00288@TESTLAB.LOCAL\", \"MWIATER00002@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"RDP access via groups for user $name","id":"tmpl:1600268982320","createdAt":1600268982320,"text":"RDP access via groups for user $name","cypher":"MATCH p=(:User {name:$name})-[:CanRDP]->(:Computer)\nRETURN p\nUNION ALL\nMATCH p=(:User {name:$name})-[:MemberOf*1..10]->(:Group)-[:CanRDP]->(:Computer)\nRETURN p","params":[{"name":"$name","dataType":"String","suggestionLabel":null,"suggestionProp":null,"cypher":"return [\"BWEST00174@TESTLAB.LOCAL\", \"SNAZAR00121@TESTLAB.LOCAL\"]"}],"hasCypherErrors":false},{"name":"Show all communities","id":"tmpl:1600275150895","createdAt":1600275150895,"text":"Show all communities","cypher":"MATCH p=(u:User)-[r]-(:Group) WHERE u.louvainCommunityId IS NOT NULL RETURN p","params":[],"hasCypherErrors":false},{"name":"Recalls all members of a given Louvain community","id":"tmpl:1607545434391","createdAt":1607545434391,"text":"Show members of community $id","cypher":"MATCH (u:User {louvainCommunityId: $id})\nRETURN u","params":[{"name":"$id","dataType":"Integer","suggestionLabel":"User","suggestionProp":"louvainCommunityId","cypher":null}],"hasCypherErrors":false},{"name":"Find all the systems a community can remote to","id":"tmpl:1607545733806","createdAt":1607545733806,"text":"RDP access for community $id","cypher":"MATCH p=(u:User {louvainCommunityId:$id})-[:MemberOf*1..]->(:Group)-[:CanRDP]->(:Computer)\nOPTIONAL MATCH p2=(u)-[:CanRDP]->()\nRETURN p, p2","params":[{"name":"$id","dataType":"Integer","suggestionLabel":"User","suggestionProp":"louvainCommunityId","cypher":null}],"hasCypherErrors":false}],"hiddenRelationshipTypes":["GENERIC_ALL"],"hiddenCategories":[],"hideUncategorisedData":true,"parentPerspectiveId":null,"labels":{"Group":[{"propertyKey":"objectid","type":"Group","dataType":"string"},{"propertyKey":"name","type":"Group","dataType":"string"},{"propertyKey":"highvalue","type":"Group","dataType":"boolean"},{"propertyKey":"betweenness","type":"Group","dataType":"number"},{"propertyKey":"betweennessCalibrated","type":"Group","dataType":"bigint"},{"propertyKey":"domain","type":"Group","dataType":"string"},{"propertyKey":"enabled","type":"Group","dataType":"boolean"},{"propertyKey":"lastlogon","type":"Group","dataType":"bigint"},{"propertyKey":"displayname","type":"Group","dataType":"string"},{"propertyKey":"pwdlastset","type":"Group","dataType":"bigint"},{"propertyKey":"owned","type":"Group","dataType":"boolean"}],"Domain":[{"propertyKey":"name","type":"Domain","dataType":"string"},{"propertyKey":"highvalue","type":"Domain","dataType":"boolean"},{"propertyKey":"betweenness","type":"Domain","dataType":"number"},{"propertyKey":"betweennessCalibrated","type":"Domain","dataType":"bigint"},{"propertyKey":"domain","type":"Domain","dataType":"string"}],"GPO":[{"propertyKey":"objectid","type":"GPO","dataType":"string"},{"propertyKey":"name","type":"GPO","dataType":"string"},{"propertyKey":"betweennessCalibrated","type":"GPO","dataType":"bigint"},{"propertyKey":"betweenness","type":"GPO","dataType":"number"},{"propertyKey":"domain","type":"GPO","dataType":"string"}],"OU":[{"propertyKey":"objectid","type":"OU","dataType":"string"},{"propertyKey":"name","type":"OU","dataType":"string"},{"propertyKey":"blocksInheritance","type":"OU","dataType":"boolean"},{"propertyKey":"betweennessCalibrated","type":"OU","dataType":"bigint"},{"propertyKey":"betweenness","type":"OU","dataType":"number"},{"propertyKey":"domain","type":"OU","dataType":"string"}],"Computer":[{"propertyKey":"objectid","type":"Computer","dataType":"string"},{"propertyKey":"name","type":"Computer","dataType":"string"},{"propertyKey":"highvalue","type":"Computer","dataType":"boolean"},{"propertyKey":"operatingsystem","type":"Computer","dataType":"string"},{"propertyKey":"enabled","type":"Computer","dataType":"boolean"},{"propertyKey":"betweenness","type":"Computer","dataType":"number"},{"propertyKey":"betweennessCalibrated","type":"Computer","dataType":"bigint"},{"propertyKey":"owned","type":"Computer","dataType":"boolean"},{"propertyKey":"domain","type":"Computer","dataType":"string"}],"User":[{"propertyKey":"objectid","type":"User","dataType":"string"},{"propertyKey":"name","type":"User","dataType":"string"},{"propertyKey":"enabled","type":"User","dataType":"boolean"},{"propertyKey":"lastlogon","type":"User","dataType":"bigint"},{"propertyKey":"displayname","type":"User","dataType":"string"},{"propertyKey":"pwdlastset","type":"User","dataType":"bigint"},{"propertyKey":"betweenness","type":"User","dataType":"number"},{"propertyKey":"hasspn","type":"User","dataType":"boolean"},{"propertyKey":"betweennessCalibrated","type":"User","dataType":"bigint"},{"propertyKey":"owned","type":"User","dataType":"boolean"},{"propertyKey":"domain","type":"User","dataType":"string"}],"Base":[]},"metadata":{"indexes":[{"label":null,"type":"native","propertyKeys":[]},{"label":"Group","type":"native","propertyKeys":["name","objectid"]},{"label":"Domain","type":"native","propertyKeys":["name"]},{"label":"GPO","type":"native","propertyKeys":["objectid","name"]},{"label":"OU","type":"native","propertyKeys":["name","objectid"]},{"label":"User","type":"native","propertyKeys":["name","objectid"]},{"label":"Computer","type":"native","propertyKeys":["objectid","name"]}],"pathSegments":[{"source":"User","relationshipType":"PATH","target":"User"},{"source":"GPO","relationshipType":"PATH","target":"OU"},{"source":"User","relationshipType":"PATH","target":"Domain"},{"source":"Computer","relationshipType":"PATH","target":"User"},{"source":"Domain","relationshipType":"PATH","target":"Group"},{"source":"Domain","relationshipType":"PATH","target":"Domain"},{"source":"User","relationshipType":"PATH","target":"Computer"},{"source":"Computer","relationshipType":"PATH","target":"Domain"},{"source":"Group","relationshipType":"PATH","target":"Computer"},{"source":"Domain","relationshipType":"PATH","target":"Computer"},{"source":"Computer","relationshipType":"PATH","target":"OU"},{"source":"Computer","relationshipType":"PATH","target":"Group"},{"source":"User","relationshipType":"PATH","target":"Group"},{"source":"GPO","relationshipType":"PATH","target":"Computer"},{"source":"OU","relationshipType":"PATH","target":"OU"},{"source":"GPO","relationshipType":"PATH","target":"Group"},{"source":"OU","relationshipType":"PATH","target":"User"},{"source":"OU","relationshipType":"PATH","target":"Computer"},{"source":"Domain","relationshipType":"PATH","target":"User"},{"source":"Group","relationshipType":"PATH","target":"OU"},{"source":"OU","relationshipType":"PATH","target":"Domain"},{"source":"Group","relationshipType":"PATH","target":"Domain"},{"source":"GPO","relationshipType":"PATH","target":"Domain"},{"source":"Group","relationshipType":"PATH","target":"Group"},{"source":"Group","relationshipType":"PATH","target":"User"},{"source":"GPO","relationshipType":"PATH","target":"User"},{"source":"OU","relationshipType":"PATH","target":"Group"},{"source":"User","relationshipType":"PATH","target":"OU"},{"source":"Domain","relationshipType":"PATH","target":"OU"},{"source":"Computer","relationshipType":"PATH","target":"Computer"},{"source":"Group","relationshipType":"AdminTo","target":"Computer"},{"source":"Group","relationshipType":"GetChanges","target":"Domain"},{"source":"Computer","relationshipType":"AllowedToDelegate","target":"Computer"},{"source":"User","relationshipType":"AllowedToDelegate","target":"Computer"},{"source":"Group","relationshipType":"Owns","target":"Domain"},{"source":"User","relationshipType":"ExecuteDCOM","target":"Computer"},{"source":"Group","relationshipType":"ExecuteDCOM","target":"Computer"},{"source":"Group","relationshipType":"GetChangesAll","target":"Domain"},{"source":"User","relationshipType":"CanRDP","target":"Computer"},{"source":"Group","relationshipType":"CanRDP","target":"Computer"},{"source":"Group","relationshipType":"WriteDacl","target":"Domain"},{"source":"Group","relationshipType":"WriteOwner","target":"Domain"},{"source":"Domain","relationshipType":"GpLink","target":"OU"},{"source":"GPO","relationshipType":"GpLink","target":"OU"},{"source":"GPO","relationshipType":"GpLink","target":"Domain"},{"source":"Domain","relationshipType":"GpLink","target":"Domain"},{"source":"Group","relationshipType":"MemberOf","target":"User"},{"source":"Computer","relationshipType":"MemberOf","target":"Group"},{"source":"User","relationshipType":"MemberOf","target":"Group"},{"source":"Group","relationshipType":"MemberOf","target":"Group"},{"source":"User","relationshipType":"MemberOf","target":"User"},{"source":"Computer","relationshipType":"MemberOf","target":"User"},{"source":"Group","relationshipType":"AddMember","target":"Group"},{"source":"Group","relationshipType":"ForceChangePassword","target":"User"},{"source":"GPO","relationshipType":"RAW_PATH","target":"Group"},{"source":"Group","relationshipType":"RAW_PATH","target":"Group"},{"source":"User","relationshipType":"RAW_PATH","target":"User"},{"source":"OU","relationshipType":"RAW_PATH","target":"Domain"},{"source":"Group","relationshipType":"RAW_PATH","target":"Domain"},{"source":"Domain","relationshipType":"RAW_PATH","target":"Group"},{"source":"OU","relationshipType":"RAW_PATH","target":"User"},{"source":"Computer","relationshipType":"RAW_PATH","target":"Group"},{"source":"User","relationshipType":"RAW_PATH","target":"Computer"},{"source":"Domain","relationshipType":"RAW_PATH","target":"Domain"},{"source":"OU","relationshipType":"RAW_PATH","target":"Group"},{"source":"Group","relationshipType":"RAW_PATH","target":"User"},{"source":"Domain","relationshipType":"RAW_PATH","target":"Computer"},{"source":"Domain","relationshipType":"RAW_PATH","target":"User"},{"source":"Group","relationshipType":"RAW_PATH","target":"OU"},{"source":"Computer","relationshipType":"RAW_PATH","target":"Domain"},{"source":"OU","relationshipType":"RAW_PATH","target":"OU"},{"source":"Computer","relationshipType":"RAW_PATH","target":"User"},{"source":"Computer","relationshipType":"RAW_PATH","target":"OU"},{"source":"Computer","relationshipType":"RAW_PATH","target":"Computer"},{"source":"GPO","relationshipType":"RAW_PATH","target":"OU"},{"source":"User","relationshipType":"RAW_PATH","target":"Group"},{"source":"GPO","relationshipType":"RAW_PATH","target":"User"},{"source":"Domain","relationshipType":"RAW_PATH","target":"OU"},{"source":"GPO","relationshipType":"RAW_PATH","target":"Domain"},{"source":"Group","relationshipType":"RAW_PATH","target":"Computer"},{"source":"User","relationshipType":"RAW_PATH","target":"Domain"},{"source":"GPO","relationshipType":"RAW_PATH","target":"Computer"},{"source":"User","relationshipType":"RAW_PATH","target":"OU"},{"source":"OU","relationshipType":"RAW_PATH","target":"Computer"},{"source":"Domain","relationshipType":"Contains","target":"Computer"},{"source":"OU","relationshipType":"Contains","target":"User"},{"source":"Domain","relationshipType":"Contains","target":"OU"},{"source":"OU","relationshipType":"Contains","target":"Computer"},{"source":"OU","relationshipType":"Contains","target":"OU"},{"source":"Domain","relationshipType":"Contains","target":"User"},{"source":"Group","relationshipType":"GenericAll","target":"User"},{"source":"Group","relationshipType":"GenericAll","target":"Group"},{"source":"Group","relationshipType":"GenericAll","target":"Domain"},{"source":"Group","relationshipType":"GenericAll","target":"Computer"},{"source":"Computer","relationshipType":"HasSession","target":"User"},{"source":"Group","relationshipType":"DCSync","target":"Domain"}],"stats":{"labels":{},"relationshipTypes":{"AddMember":3,"AdminTo":2278,"AllowedToDelegate":100,"CanRDP":100,"Contains":1022,"DCSync":2,"ExecuteDCOM":100,"ForceChangePassword":1,"GenericAll":1501,"GetChanges":4,"GetChangesAll":3,"GpLink":37,"HasSession":489,"MemberOf":2751,"Owns":1,"PATH":0,"PATH_0":1,"RAW_PATH":0,"WriteDacl":2,"WriteOwner":2}}},"version":"2.2.1","isAuto":false,"sceneActions":[{"name":"Show shortest attack paths","id":"bae9fb50-d5eb-11ec-b4bc-83eb494ee32f","createdAt":1652796897162,"cypher":"CALL gds.graph.drop(\"bloom-temp\", false) YIELD graphName\nWITH count(*) AS cnt\n\nCALL gds.graph.project.cypher(\"bloom-temp\",\n\t\"MATCH (a) RETURN id(a) AS id\",\n    \"MATCH (a)-[r]->(b) RETURN id(a) AS source, id(b) AS target, type(r) AS type\") YIELD graphName\nWITH graphName\n\nWITH graphName, head($nodes) AS src, tail($nodes) AS dsts\nUNWIND dsts AS dst\nCALL gds.shortestPath.dijkstra.stream(graphName, {\n    sourceNode: src,\n    targetNode: dst\n}) YIELD sourceNode, nodeIds\nUNWIND apoc.coll.pairsMin([sourceNode] + nodeIds) AS pair\nMATCH (a) WHERE id(a) = pair[0]\nMATCH (b) WHERE id(b) = pair[1]\nMATCH path = (a)-[r]-(b) WHERE NOT type(r) = \"ATTACK_PATH\"\nRETURN path\n","isUpdateQuery":null,"categories":null,"relationshipTypes":null,"hasCypherErrors":false}]}